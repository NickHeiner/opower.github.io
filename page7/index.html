<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="description" content="Opower Engineering Blog">
        <meta name="author" content="Opower's Engineering Team">

        <link rel="alternate" type="application/rss+xml" title="Opower Engineering Blog" href="/feed.xml" />

        <title>Opower | Engineering Blog</title>

        <!-- Bootstrap core CSS -->
        <link rel="stylesheet" href="/css/bootstrap.min.css">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Pluggy Font -->
        <link rel="stylesheet" href="/css/pluggyfont.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/custom.css">

    </head>

    <body>

    <!-- Wraps page content to push the footer down -->
    <div id="wrap">

        <div class="navbar navbar-inverse navbar-fixed-top">
            <div class="container">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">OP<b>O</b>WER</a>
                <div class="nav-collapse collapse">
                    <ul class="nav navbar-nav">
                        <li><a href="/">Home</a></li>
                        <li><a href="/archive.html">Archive</a></li>
                    </ul>
                </div><!--/.nav-collapse -->
            </div>
        </div>

        <div class="container">
            <div class="row">
                <div class="col-lg-8">

                <div class="page-header">
  <h1>Blog Posts</h1>
</div>
<div class="posts">
  
  <div class="post">
      <h2><a href="/2009/10/15/agile-impressions-5-iterations-in">Agile impressions, 5 iterations in...</a></h2>
      <p class="meta pull-right">Written on October 15, 2009 by tom.vaughan</p>
      <div class="clearfix"></div>
      <div class="post-content">
      <p>I’m assuming from the amount of hype out there that if a development team isn’t using “Agile” right now, they probably feel like the one kid on the block who didn’t have a Nintendo (with the Duck Hunt option, of course).</p>

<p><img src="/img/duckhunt-300x165.png" alt="duckhunt" /></p>

<p>Well, we here at OPOWER loved our Duck Hunt, so we’ve been attempting to use “Agile” for the last 5 months or so.  Agile means a lot of things to a lot of people, so I’ll spell out what it means for us and then reflect on some of the pros, cons, and room-for-improvement in our practice.</p>

<ul>
  <li>&lt;cringe&gt;Embrace change&lt;/cringe&gt; (duh)…but especially in this startup environment, we need to remember to do no more than is necessary, because any “extra mile” functionality is likely to be totally unused as priorities and direction changes.</li>
  <li>Be scientific about development…<a href="/2009/08/19/measuring-our-awesomeness-iteration-by-iteration">measure, measure measure</a>.  We track velocities, average-open-days-per-bug-by-severity, etc.</li>
  <li>“Individuals and interactions over processes and tools”…we self-organize, aren’t afraid to try new combinations of responsibilities and assignments, provide regular feedback to each other and we don’t dictate a development environment or technology stack.</li>
</ul>

<p>The best thing about the technical side of this company is that the entire development team and project management team is on-board with the idea of rapid iterations, continuous improvement and a focus on technical excellent and “maximizing the amount of work not done.”</p>

<p>This manifests itself in several practices that I’d chalk up in the “pro” column:</p>

<ul>
  <li>Light weight documentation…use wikis and person-to-person contact (recorded on bug tickets for posterity) to flush out designs and requirement.</li>
  <li>Continuous integration and continuous improvement (we just installed Sonar last week…we’ll blog about its effectiveness later)</li>
  <li>Regular code reviews, 360 reviews, and “how did we collectively perform this iteration” meetings</li>
  <li>Few formal meetings, many informal, impromptu “drive bys”</li>
</ul>

<p><strong>But the best thing about our Agile environment</strong> right now is that it is a work-in-progress “process framework” that repeats quickly enough for us to remember what to improve.</p>

<p>What do I mean by that?</p>

<p>It’s my impression that on the longer, more drawn-out software engagements (say…6 or 12 months), you can make a series of mistakes in the design phase, the build phase, the qa phase, etc. and then by the time you’re on the next project you repeat all those mistakes again because it’s been 6 or 12 months since you last learned your lesson.  Instead of concrete lessons, you develop a career full of “gut instincts.”</p>

<p>We’re still honing in on the right amount of measurement and process for OPOWER, but because we’re all on board with the idea of quick-hit iterations with a continuous focus on improvement, I have high hopes for our ability to become (stay?) a top-notch software engineering organization.</p>

<p><img src="/img/duckhunt_many-300x213.png" alt="duckhunt_many" /></p>

<p>There’s lots of room for improvement, that I think I’ll save for another post on another day.  We could definitely stand to “communicate out” more – with the product team and with our operations team.  We need to do a better job of making sure our iterations are lining up with the corporate strategy.  We could improve on the whole “customer collaboration over contract negotiation” part of the manifesto.  But you can only squeeze that trigger so fast, right?</p>

      </div>
  </div>
  
  <div class="post">
      <h2><a href="/2009/09/18/best-javadoc-ever">Best javadoc ever</a></h2>
      <p class="meta pull-right">Written on September 18, 2009 by yoni.ben-meshulam</p>
      <div class="clearfix"></div>
      <div class="post-content">
      <pre><code>/**
  * Whatever to satisfy whatever.
  *
  * @author dave.copeland
  */
</code></pre>


      </div>
  </div>
  
  <div class="post">
      <h2><a href="/2009/09/13/expectationstrouble">expectations==trouble</a></h2>
      <p class="meta pull-right">Written on September 13, 2009 by yoni.ben-meshulam</p>
      <div class="clearfix"></div>
      <div class="post-content">
      <p><img src="/img/wtf_javascript.png" alt="expectations will get you in trouble :)" /></p>

      </div>
  </div>
  
  <div class="post">
      <h2><a href="/2009/09/10/when-is-a-null-not-a-null">When is a null not a null?</a></h2>
      <p class="meta pull-right">Written on September 10, 2009 by tom.vaughan</p>
      <div class="clearfix"></div>
      <div class="post-content">
      <p>tl/dr: <em>Don’t have a non-null object’s .toString() display “null”. It’s confusing and not helpful when looking at object states in IDE debuggers.</em></p>

<p>I recently converted the attribute of our Person POJO that stored a user’s email address from a java.lang.String to a javax.mail.InternetAddress.  Call it not enough testing or lack of imagination, but I introduced a Null Pointer Exception in a back-office web flow where a new user is created for our customer service application.  When a new CSR account is created and the email address is left blank, an NPE gets thrown up.  Embarrassing, but easy to fix, right?</p>

<p>Just looking at the stack trace narrows it down immediately:</p>

<pre><code>2009-09-09 16:56:53,636 WARN  [btpool0-1] [REPORT] [WARN] Handler execution resulted in exception
java.lang.NullPointerException
	at javax.mail.internet.InternetAddress.parse(InternetAddress.java:609)
	at javax.mail.internet.InternetAddress.parse(InternetAddress.java:569)
	at javax.mail.internet.InternetAddress.(InternetAddress.java:105)
	at poscore.db.InternetAddressUserType.deepCopy(InternetAddressUserType.java:93)
	at org.hibernate.type.CustomType.deepCopy(CustomType.java:179)
	at org.hibernate.type.TypeFactory.deepCopy(TypeFactory.java:374)
</code></pre>

<p>Ahh…yeah…that custom hibernate type I wrote to translate VARCHARs to InternetAddresses and vice versa.  Ok, what does that deep copy method look like?</p>

<div class="highlight"><pre><code class="java">    
<span class="kd">public</span> <span class="n">Object</span> <span class="nf">deepCopy</span><span class="o">(</span><span class="n">Object</span> <span class="n">value</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">HibernateException</span> <span class="o">{</span>
    <span class="k">if</span><span class="o">(</span><span class="n">value</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="n">InternetAddress</span> <span class="n">original</span> <span class="o">=</span> <span class="o">(</span><span class="n">InternetAddress</span><span class="o">)</span><span class="n">value</span><span class="o">;</span>
    <span class="n">InternetAddress</span> <span class="n">copy</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">copy</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InternetAddress</span><span class="o">(</span><span class="n">original</span><span class="o">.</span><span class="na">getAddress</span><span class="o">());</span>
    <span class="o">}</span>
    <span class="k">catch</span> <span class="o">(</span><span class="n">AddressException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">HibernateException</span><span class="o">(</span><span class="s">&quot;Unable to deep copy email address &#39;&quot;</span> <span class="o">+</span> <span class="n">original</span><span class="o">.</span><span class="na">getAddress</span><span class="o">()</span> <span class="o">+</span> <span class="s">&quot;&#39;&quot;</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">copy</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div>

<p>It turns out, the error is right here:</p>

<div class="highlight"><pre><code class="java"><span class="n">copy</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InternetAddress</span><span class="o">(</span><span class="n">original</span><span class="o">.</span><span class="na">getAddress</span><span class="o">());</span>
</code></pre></div>

<p>You can’t pass a null to the InternetAddress constructor.  It was late in the day and I must not have internalized that there’s no way <em>value</em> or <em>original</em> could be null, because my first instinct was that the NPE was actually the result of calling “.getAddress()” on a null <em>original</em> object….not that the constructor can’t take a null.</p>

<p>While I was on that assumption (that it was the <em>original</em> object that was null), I fired up my debugger and got confused by what appeared to be null-checks failing to check nulls. Check out this screen shot of the NPE about to be thrown after what appears to be 2 null checks failing to prevent the NPE:</p>

<p><img src="/img/null_internet_address.png" alt="null_internet_address" /></p>

<p>The arrows marked (A) and (B) shows what appear to be null objects passing null checks (in the top pane) even though they’re being reported as null (in the bottom pane).  The green line (C) shows the code falling through to that line just before it throws up the NPE.</p>

<p>Of course, <em>value</em> and <em>original</em> aren’t null at all…it’s just that their .toString() methods report them to be null.  Here’s the InternetAddress.toString method:</p>

<pre><code>276   public String toString() {
277       if (encodedPersonal == null &amp;&amp; personal != null)
278           try {
279	              encodedPersonal = MimeUtility.encodeWord(personal);
280           } catch (UnsupportedEncodingException ex) { }
281
282       if (encodedPersonal != null)
283           return quotePhrase(encodedPersonal) + " &lt;" + address + "&gt;";
284       else if (isGroup() || isSimple())
285           return address;
286       else
287           return "&lt;" + address + "&gt;";
288   }
</code></pre>

<p>In my situation, I fell in to the <code>else if(isGroup() || isSimple())</code> case, which returns <code>address</code>, which is null, so the <code>.toString()</code> for the whole InternetAddress object is “null.”</p>

<p>I think the toString() method could benefit from another null-check right at line 284, which would mean an InternetAddress object with a null internal <code>address</code> String would display as “&lt;null&gt;” …that’s a more immediate clue that the object itself isn’t null.</p>

      </div>
  </div>
  
  <div class="post">
      <h2><a href="/2009/08/28/move-meetings-to-move-developers">Move meetings to move developers</a></h2>
      <p class="meta pull-right">Written on August 28, 2009 by tom.vaughan</p>
      <div class="clearfix"></div>
      <div class="post-content">
      <p>Here’s the scenario:</p>

<p>You cruise in to the office at 8:45, get your coffee, check the reddits, and ignore that email from your parents asking if their computer picked up a virus because McAfee won’t stop popping up a tooltray icon helpfully informing them that they’re totally vulnerable.  Right around 9:15, you get motivated to tackle that 2 point user story for the current iteration.</p>

<p>You head over to the wiki, check out the specs for the requirement, find out what the Trac ticket number is and see if there are any comments with last minute advice or dependencies.  None?  Good. . . let’s get started!</p>

<p>Oh, huh… it’s 9:40.  There’s that all-hands meeting at 10 o’clock.  I <em>could</em> get started, but I’m not really going to get anything done in 20 minutes really… and that link to the <a href="http://www.buzzfeed.com/akdobbins/three-keyboard-cat-moon-shirt">keyboard-cat-three-wolf-t-shirt</a> <em>did</em> look interesting.</p>

<p>The 10 o’clock meeting runs a little long, and then there’s the lunch train, and suddenly it’s the afternoon and you haven’t been in The Zone once.</p>

<h3 id="the-zone">The Zone</h3>

<p>We’ve all been in The Zone – that magical place where time appears to stop and you rock out an insane amount of code in what seems like 10 minutes, but when you look up from your keyboard the sun is down and the cleaning crew is giving you a weird look because you didn’t realize you were trying to sing along to Sigur Ros.</p>

<p>Trying to force yourself into The Zone is like trying to force yourself to see through those <a href="http://cdn-write.demandstudios.com/upload//0000/000/90/4/94.gif">stereograms</a> (hint: it’s always a Schooner).  And as hard as it is to get <em>in</em> The Zone, it’s annoying easily to get <em>out</em> of The Zone.</p>

<p>There are a lot of recommendations out there to help create “zone-friendly” work places including:</p>

<ul>
  <li>separate offices</li>
  <li>ambient music</li>
  <li>leaving something intentionally broken the night before to give you that excuse to dive in the next morning</li>
  <li><a href="http://cdn-write.demandstudios.com/upload//0000/000/90/4/94.gif">shift your tasks to the upper right</a></li>
  <li><a href="http://www.paulgraham.com/makersschedule.html">Paul Graham’s thoughts</a> on the matter</li>
  <li>etc. etc.</li>
</ul>

<p>We were wrapping up our all-hands meeting yesterday when the ever-perceptive Dave noted that our weekly meeting schedules were really not all that Zone-Friendly.  With a couple of exceptions, we had standing meetings along the following schedule:</p>

<p><img src="/img/zone_unfriendly.png" alt="Standing Meetings" /></p>

<p>And keep in mind, that’s just the standing meetings, so it’s the bare-minimum one would expect.  Now let’s add some “procrastination shading” to that calendar to demonstrate the actual standing meeting impact:</p>

<p><img src="/img/zone_unfriendly_shaded.png" alt="Standing Meetings" /></p>

<p>If we shuffled some meetings around (especially around the meat of the middle of the week), I think we could end up “finding” 2 or 3 hours a week more conducive to The Zone:</p>

<p><img src="/img/zone_friendly_shaded.png" alt="Friendly Standing Meetings" /></p>

<p>Of course, this is an idealized example, but it’s something we’re thinking about and playing with.</p>

<p>What do you guys out there in development land do?  Any recommendations of particular effectiveness?</p>

      </div>
  </div>
  
</div>

<ul class="pager">
  
  <li class="previous"><a href="/page8">&larr; Older</a></li>
  
  
  <li class="next"><a href="/page6">Newer &rarr;</a></li>
  
</ul>


                </div>
                <div class="sidebar col-lg-4">
                    <div class="panel">
                        <div class="panel-heading">
                            <h3 class="panel-title">Opower Projects</h3>
                        </div>
                        <!-- TODO: Construct this list with live data from the Github API -->
                        <ul class="list-group">
                            <li class="project list-group-item">
                                <h4><a href="https://github.com/opower/elroi">elroi</a></h4>
                                <div class="description">A JavaScript charting &amp; graphing</div>
                                <div class="stats">
                                    <div class="language">JavaScript</div>
                                    <div class="updatedon">Updated on August 2, 2013</div>
                                    <div class="forks">11 forks</div>
                                    <div class="watchers">7 watchers</div>
                                </div>
                            </li>
                            <li class="project list-group-item">
                                <h4><a href="https://github.com/opower/sensu-metrics-relay">sensu-metrics-relay</a></h4>
                                <div class="description">WizardVan: A Sensu Metrics Relay</div>
                                <div class="stats">
                                    <div class="language">null</div>
                                    <div class="updatedon">Updated on July 30, 2013</div>
                                    <div class="forks">0 forks</div>
                                    <div class="watchers">0 watchers</div>
                                </div>
                            </li>
                            <li class="project list-group-item">
                                <h4><a href="https://github.com/opower/jpile">jpile</a></h4>
                                <div class="description">Java Persistence Infile LoadEr</div>
                                <div class="stats">
                                    <div class="language">Java</div>
                                    <div class="updatedon">Updated on July 31, 2013</div>
                                    <div class="forks">9 forks</div>
                                    <div class="watchers">7 watchers</div>
                                </div>
                            </li>
                        </ul> <!-- /.list-group -->
                    </div> <!-- /.panel -->
                    <div class="panel">
                        <div class="panel-heading">
                            <h3 class="panel-title">Personal Projects</h3>
                        </div>
                        <!-- TODO: Construct this list with live data from the Github API -->
                        <ul class="list-group">
                            <li class="project list-group-item">
                                <h4><a href="https://github.com/dylang/shortid">shortid</a></h4>
                                <div class="description">Short id generator. Url-friendly. Non-predictable. Cluster-compatible.</div>
                                <div class="stats">
                                    <div class="author"><a href="https://github.com/dylang">Dylan Greene</a></div>
                                    <div class="language">JavaScript</div>
                                    <div class="updatedon">Updated on July 20, 2013</div>
                                    <div class="forks">9 forks</div>
                                    <div class="watchers">4 watchers</div>
                                </div>
                            </li>
                            <li class="project list-group-item">
                                <h4><a href="https://github.com/seancolyer/gmail-crypt">gmail-crypt</a></h4>
                                <div class="description">An OpenPGP browser (currently Chrome) extension that integrates tightly with Gmail and does encryption/decryption via Javascript.</div>
                                <div class="stats">
                                    <div class="author"><a href="https://github.com/seancolyer">Sean Colyer</a></div>
                                    <div class="language">JavaScript</div>
                                    <div class="updatedon">Updated on July 14, 2013</div>
                                    <div class="forks">7 forks</div>
                                    <div class="watchers">18 watchers</div>
                                </div>
                            </li>
                        </ul> <!-- /.list-group -->
                    </div> <!-- /.panel -->
                </div>

            </div>
        </div><!-- /.container -->

    </div><!-- /#wrap -->

    <div id="footer">
        <div class="container">
            <div class="row">
                <div class="col-lg-6">
                    &copy; 2013 <a href="http://opower.com">Opower</a> &reg;
                    All content represents the opinion of the author and does not represent Opower.<br/>
                    <a href="http://opower.com/company/privacy-policy/">Privacy</a> :
                    <a href="http://opower.com/company/terms/">Terms</a>
                </div>
                <div class="col-lg-6">
                    <ul class="pull-right">
                        <li><a href="http://github.com/opower">Github</a></li>
                        <li><a href="http://twitter.com/opower">Twitter</a></li>
                        <li><a href="http://www.linkedin.com/company/opower">LinkedIn</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

  </body>
</html>
